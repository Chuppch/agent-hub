server:
  port: 8091

# 线程池配置
thread:
  pool:
    executor:
      config:
        core-pool-size: 20
        max-pool-size: 50
        keep-alive-time: 5000
        block-queue-size: 5000
        policy: CallerRunsPolicy

# 数据库配置；启动时配置数据库资源信息
spring:
  datasource:
    # MySQL 配置（业务数据库）- 端口 20001
    mysql:
      driver-class-name: com.mysql.cj.jdbc.Driver
      url: jdbc:mysql://43.139.213.157:20001/ai-agent-station?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
      username: root
      password: 123456
      hikari:
        pool-name: Retail_HikariCP
        maximum-pool-size: 10
        minimum-idle: 5
        idle-timeout: 30000
        connection-timeout: 30000
        max-lifetime: 1800000
        auto-commit: true
        connection-test-query: SELECT 1
    # PostgreSQL 配置（向量数据库）- 端口 20005
    pgvector:
      driver-class-name: org.postgresql.Driver
      url: jdbc:postgresql://43.139.213.157:20005/ai-rag-knowledge?tcpKeepAlive=true&socketTimeout=60
      username: postgres
      password: postgres
      hikari:
        pool-name: PgVectorHikariPool
        maximum-pool-size: 5
        minimum-idle: 2
        idle-timeout: 600000  # 改为 10 分钟（600000ms），避免空闲连接被断开
        connection-timeout: 30000
        max-lifetime: 1800000  # 30 分钟
        auto-commit: true
        connection-test-query: SELECT 1
        validation-timeout: 5000  # 连接验证超时
        leak-detection-threshold: 60000  # 连接泄漏检测阈值（60秒）
  # Redis 配置
  data:
    redis:
      host: 43.139.213.157
      port: 20003
      password: # Redis 无密码
      timeout: 3000
      database: 0
  ai:
    openai:
      base-url: https://dashscope.aliyuncs.com/compatible-mode  # 改为阿里百炼，不包含 /v1
      api-key: sk-cb3fa344c3cc495d95a34d2cc9c67280
      embedding:
        options:
          model: text-embedding-v4
          dimensions: 1536  # 显式指定维度为 1536，与数据库表 vector_store_openai 的 VECTOR(1536) 定义一致
    agent:
      auto-config:
        enabled: true
    # 禁用 PgVectorStore 自动配置，使用手动配置的 Bean（使用 vector_store_openai 表）
    vectorstore:
      pgvector:
        enabled: false

# MyBatis 配置【如需使用记得打开】
mybatis:
 mapper-locations: classpath:/mybatis/mapper/*.xml
 config-location:  classpath:/mybatis/config/mybatis-config.xml

# 日志
logging:
  level:
    root: info
  config: classpath:logback-spring.xml